# Author: Shivesh Prakash
# This file extracts an array of data from MODTRAN corresponding to a specific feature

import numpy as np
import matplotlib.pyplot as plt


def extract_from_MODTRAN(json: dict, start_wavelength: int, end_wavelength: int, deeper_by=0, wider_by=0) -> np.array:
    """This function returns an array of data points corresposnding to the specific feature.

    Args:
        json = the docs_json variable copied from the website source
        feature_wavelength = the feature wavelength around which data is to be extracted
        deeper_by = the amount by which the y-axis is to be lowered in order to fit in with the satellite data
        wider_by = the amount by which the x-axis is to be widened in order to fit in with the satellite data

    Outputs:
        np.array consisting of x and y axis data points, wavelength in nm on x-axis and transmittance on the y-axis"""
    key = list(json.keys())[0]
    ind = 0
    for i in range(len(json[key]['roots']['references'])):
        if 'data' in json[key]['roots']['references'][i]['attributes']:
            ind = i

    xpoint = np.array(
        json[key]['roots']['references'][ind]['attributes']['data']['x'])
    ypoints = np.array(
        json[key]['roots']['references'][ind]['attributes']['data']['y'])
    xpoints = np.array([d * 1000 for d in xpoint])

    n1, n2 = start_wavelength, end_wavelength
    xp_temp = np.array([d for d in xpoints if n1 < d < n2])
    pos = [list(xpoints).index(d) for d in list(xpoints) if n1 < d < n2]
    optimised_y = []
    optimised_x = []
    for i in pos:
        if ypoints[i] < 0.91:
            optimised_y.append(ypoints[i] - deeper_by)
        else:
            optimised_y.append(ypoints[i])
    x_of_min = xp_temp[np.argmin(ypoints[pos])]
    for point in xp_temp:
        if point < x_of_min:
            optimised_x.append(point - wider_by)
        elif point > x_of_min:
            optimised_x.append(point + wider_by)
        else:
            optimised_x.append(point)
    yp = np.array(optimised_y)
    xp = np.array(optimised_x)
    plt.plot(xp, yp)
    plt.show()

    return np.array([xp, yp])

doc = {"56b32a2b-fe9c-4115-8c3f-c692609fd3e1":{"roots":{"references":[{"attributes":{"text":""},"id":"51570","type":"Title"},
    {"attributes":{"bottom_units":"screen","fill_alpha":{"value":0.5},"fill_color":{"value":"lightgrey"},"left_units":"screen","level":"overlay","line_alpha":
        {"value":1.0},"line_color":{"value":"black"},"line_dash":[4,4],"line_width":{"value":2},"render_mode":"css","right_units":"screen","top_units":"screen"}
        ,"id":"51577","type":"BoxAnnotation"},{"attributes":{},"id":"51550","type":"WheelZoomTool"},{"attributes":{},"id":"51575","type":"Selection"},{"attributes":
        {"axis_label":"WAVELENGTH (microns)","formatter":{"id":"51572","type":"BasicTickFormatter"},"ticker":{"id":"51540","type":"BasicTicker"}},"id":"51539","type":"LinearAxis"},
        {"attributes":{},"id":"51537","type":"LinearScale"},{"attributes":{},"id":"51535","type":"LinearScale"},{"attributes":{},"id":"51552","type":"ResetTool"},{"attributes":
        {"callback":'null'},"id":"51533","type":"DataRange1d"},{"attributes":{"callback":'null'},"id":"51531","type":"DataRange1d"},{"attributes":{"below":[{"id":"51539","type":"LinearAxis"}]
        ,"center":[{"id":"51543","type":"Grid"},{"id":"51548","type":"Grid"}],"left":[{"id":"51544","type":"LinearAxis"}],"plot_height":400,"plot_width":400,"renderers":[{"id":"51567","type":"GlyphRenderer"}]
        ,"title":{"id":"51570","type":"Title"},"toolbar":{"id":"51556","type":"Toolbar"},"x_range":{"id":"51531","type":"DataRange1d"},"x_scale":{"id":"51535","type":"LinearScale"},"y_range":{"id":"51533","type":"DataRange1d"}
        ,"y_scale":{"id":"51537","type":"LinearScale"}},"id":"51530","subtype":"Figure","type":"Plot"},{"attributes":{"bottom_units":"screen","fill_alpha":{"value":0.5},"fill_color":{"value":"lightgrey"}
        ,"left_units":"screen","level":"overlay","line_alpha":{"value":1.0},"line_color":{"value":"black"},"line_dash":[4,4],"line_width":{"value":2},"render_mode":"css","right_units":"screen","top_units":"screen"}
        ,"id":"51578","type":"BoxAnnotation"},{"attributes":{"callback":'null'},"id":"51555","type":"HoverTool"},{"attributes":{"callback":'null',"overlay":{"id":"51578","type":"BoxAnnotation"}}
        ,"id":"51554","type":"BoxSelectTool"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":'null',"active_scroll":"auto","active_tap":"auto","tools":[{"id":"51549","type":"PanTool"}
        ,{"id":"51550","type":"WheelZoomTool"},{"id":"51551","type":"BoxZoomTool"},{"id":"51552","type":"ResetTool"},{"id":"51553","type":"SaveTool"},{"id":"51554","type":"BoxSelectTool"}
        ,{"id":"51555","type":"HoverTool"}]},"id":"51556","type":"Toolbar"},{"attributes":{"overlay":{"id":"51577","type":"BoxAnnotation"}},"id":"51551","type":"BoxZoomTool"},{"attributes":{}
        ,"id":"51576","type":"UnionRenderers"},{"attributes":{},"id":"51553","type":"SaveTool"},{"attributes":{},"id":"51574","type":"BasicTickFormatter"},{"attributes":{"callback":'null'
        ,"data":{"x":[1.1,1.101555,1.10311,1.104665,1.10622,1.107775,1.10933,1.110885,1.11244,1.113995,1.11555,1.117105,1.11866,1.120215,1.12177,1.123325,1.12488,1.126435,1.12799,1.129545,1.1311,1.132655,1.13421,1.135765,1.13732,1.138875,1.14043,1.141985,1.14354,1.145095,1.14665,1.148205,1.14976,1.151315,1.15287,1.154425,1.15598,1.157535,1.15909,1.160645,1.1622,1.163755,1.16531,1.166865,1.16842,1.169975,1.17153,1.173085,1.17464,1.176195,1.17775,1.179305,1.18086,1.182415,1.18397,1.185525,1.18708,1.188635,1.19019,1.191745,1.1933,1.194855,1.19641,1.197965,1.19952,1.201075,1.20263,1.204185,1.20574,1.207295,1.20885,1.210405,1.21196,1.213515,1.21507,1.216625,1.21818,1.219735,1.22129,1.222845,1.2244,1.225955,1.22751,1.229065,1.23062,1.232175,1.23373,1.235285,1.23684,1.238395,1.23995,1.241505,1.24306,1.244615,1.24617,1.247725,1.24928,1.250835,1.25239,1.253945,1.2555,1.257055,1.25861,1.260165,1.26172,1.263275,1.26483,1.266385,1.26794,1.269495,1.27105,1.272605,1.27416,1.275715,1.27727,1.278825,1.28038,1.281935,1.28349,1.285045,1.2866,1.288155,1.28971,1.291265,1.29282,1.294375,1.29593,1.297485,1.29904,1.300595,1.30215,1.303705,1.30526,1.306815,1.30837,1.309925,1.31148,1.313035,1.31459,1.316145,1.3177,1.319255,1.32081,1.322365,1.32392,1.325475,1.32703,1.328585,1.33014,1.331695,1.33325,1.334805,1.33636,1.337915,1.33947,1.341025,1.34258,1.344135,1.34569,1.347245,1.3488,1.350355,1.35191,1.353465,1.35502,1.356575,1.35813,1.359685,1.36124,1.362795,1.36435,1.365905,1.36746,1.369015,1.37057,1.372125,1.37368,1.375235,1.37679,1.378345,1.3799,1.381455,1.38301,1.384565,1.38612,1.387675,1.38923,1.390785,1.39234,1.393895,1.39545,1.397005,1.39856,1.400115,1.40167,1.403225,1.40478,1.406335,1.40789,1.409445,1.411,1.412555,1.41411,1.415665,1.41722,1.418775,1.42033,1.421885,1.42344,1.424995,1.42655,1.428105,1.42966,1.431215,1.43277,1.434325,1.43588,1.437435,1.43899,1.440545,1.4421,1.443655,1.44521,1.446765,1.44832,1.449875,1.45143,1.452985,1.45454,1.456095,1.45765,1.459205,1.46076,1.462315,1.46387,1.465425,1.46698,1.468535,1.47009,1.471645,1.4732,1.474755,1.47631,1.477865,1.47942,1.480975,1.48253,1.484085,1.48564,1.487195,1.48875,1.490305,1.49186,1.493415,1.49497,1.496525,1.49808,1.499635,1.50119,1.502745,1.5043,1.505855,1.50741,1.508965,1.51052,1.512075,1.51363,1.515185,1.51674,1.518295,1.51985,1.521405,1.52296,1.524515,1.52607,1.527625,1.52918,1.530735,1.53229,1.533845,1.5354,1.536955,1.53851,1.540065,1.54162,1.543175,1.54473,1.546285,1.54784,1.549395,1.55095,1.552505,1.55406,1.555615,1.55717,1.558725,1.56028,1.561835,1.56339,1.564945,1.5665,1.568055,1.56961,1.571165,1.57272,1.574275,1.57583,1.577385,1.57894,1.580495,1.58205,1.583605,1.58516,1.586715,1.58827,1.589825,1.59138,1.592935,1.59449,1.596045,1.5976,1.599155,1.60071,1.602265,1.60382,1.605375,1.60693,1.608485,1.61004,1.611595,1.61315,1.614705,1.61626,1.617815,1.61937,1.620925,1.62248,1.624035,1.62559,1.627145,1.6287,1.630255,1.63181,1.633365,1.63492,1.636475,1.63803,1.639585,1.64114,1.642695,1.64425,1.645805,1.64736,1.648915,1.65047,1.652025,1.65358,1.655135,1.65669,1.658245,1.6598,1.661355,1.66291,1.664465,1.66602,1.667575,1.66913,1.670685,1.67224,1.673795,1.67535,1.676905,1.67846,1.680015,1.68157,1.683125,1.68468,1.686235,1.68779,1.689345,1.6909,1.692455,1.69401,1.695565,1.69712,1.698675,1.70023,1.701785,1.70334,1.704895,1.70645,1.708005,1.70956,1.711115,1.71267,1.714225,1.71578,1.717335,1.71889,1.720445,1.722,1.723555,1.72511,1.726665,1.72822,1.729775,1.73133,1.732885,1.73444,1.735995,1.73755,1.739105,1.74066,1.742215,1.74377,1.745325,1.74688,1.748435,1.74999,1.751545,1.7531,1.754655,1.75621,1.757765,1.75932,1.760875,1.76243,1.763985,1.76554,1.767095,1.76865,1.770205,1.77176,1.773315,1.77487,1.776425,1.77798,1.779535,1.78109,1.782645,1.7842,1.785755,1.78731,1.788865,1.79042,1.791975,1.79353,1.795085,1.79664,1.798195,1.79975,1.801305,1.80286,1.804415,1.80597,1.807525,1.80908,1.810635,1.81219,1.813745,1.8153,1.816855,1.81841,1.819965,1.82152,1.823075,1.82463,1.826185,1.82774,1.829295,1.83085,1.832405,1.83396,1.835515,1.83707,1.838625,1.84018,1.841735,1.84329,1.844845,1.8464,1.847955,1.84951,1.851065,1.85262,1.854175,1.85573,1.857285,1.85884,1.860395,1.86195,1.863505,1.86506,1.866615,1.86817,1.869725,1.87128,1.872835,1.87439,1.875945,1.8775,1.879055,1.88061,1.882165,1.88372,1.885275,1.88683,1.888385,1.88994,1.891495,1.89305,1.894605,1.89616,1.897715,1.89927]
        ,"y":[0.8792122,0.87951809,0.87979984,0.8800807,0.88036197,0.88064206,0.88092035,0.88119292,0.88145751,0.88172334,0.88199842,0.88227504,0.8825528,0.88282955,0.88310045,0.88336861,0.883636,0.88390303,0.88416421,0.88441479,0.88466829,0.88493192,0.88519603,0.88546419,0.88573396,0.88599807,0.88625753,0.88651377,0.88676804,0.88702208,0.88727576,0.88752824,0.88777858,0.88802856,0.8882792,0.88852775,0.8887772,0.88902688,0.88927418,0.88951904,0.88976216,0.89000553,0.89024889,0.8904919,0.89073354,0.89097363,0.89121205,0.89144933,0.89168578,0.89189613,0.89206636,0.8922416,0.89244264,0.89266735,0.89290452,0.89311963,0.89331692,0.89351183,0.89371282,0.8939448,0.89419818,0.89443237,0.89464426,0.89484656,0.89503217,0.89437789,0.88965058,0.88491565,0.8861149,0.88809866,0.88949418,0.89220738,0.89431441,0.89536625,0.89576858,0.89397675,0.89009511,0.88903511,0.89054483,0.89117754,0.89208919,0.89341229,0.89405733,0.89430881,0.89426869,0.89401424,0.89368516,0.89334339,0.89298552,0.89254636,0.89203763,0.89143455,0.89069831,0.88978678,0.88858646,0.88696843,0.88481104,0.88200504,0.87846845,0.87418193,0.8692736,0.86300159,0.85310549,0.83714062,0.81554389,0.79400492,0.78410172,0.77225709,0.73569942,0.7333672,0.79001898,0.82858139,0.83859557,0.84971184,0.86103398,0.8717342,0.88055569,0.88724375,0.89181107,0.89479512,0.89713383,0.89907897,0.90041876,0.90152031,0.90269238,0.90360624,0.9043951,0.90522355,0.90591681,0.90645963,0.90692753,0.90733469,0.90770501,0.9080686,0.90841025,0.90868104,0.90866834,0.90804881,0.90755081,0.9080016,0.90851128,0.90868986,0.90921491,0.90997565,0.91059303,0.91103768,0.91133875,0.91154522,0.91172069,0.91188598,0.91202396,0.91203219,0.91184235,0.91176265,0.91204304,0.91231728,0.91242844,0.91267741,0.91306019,0.91340011,0.91365093,0.9138329,0.91400051,0.91417587,0.91434926,0.91451627,0.91467738,0.91483587,0.91499519,0.91515541,0.91531217,0.91546386,0.91560763,0.91574389,0.91589284,0.91605926,0.91621655,0.91636515,0.91652822,0.9167006,0.91686481,0.91701841,0.91716814,0.91732031,0.91747302,0.91762424,0.91777581,0.91792732,0.91807741,0.91822755,0.91837674,0.91852266,0.91866875,0.91881794,0.91896671,0.91911268,0.91925895,0.919406,0.91955298,0.91969848,0.9198423,0.91998559,0.92012858,0.92027187,0.9204151,0.92055732,0.92069852,0.92083871,0.92097801,0.92111552,0.9212451,0.91820306,0.85574394,0.74894643,0.74247146,0.80480218,0.81727791,0.81055391,0.82130951,0.84655082,0.87455076,0.8914997,0.90153641,0.90921509,0.9148612,0.91867208,0.92084777,0.92205203,0.9228133,0.92334312,0.92370635,0.92396188,0.92415851,0.92432648,0.92447782,0.92461741,0.92475098,0.92481869,0.92378521,0.9218145,0.92172211,0.92317683,0.92357886,0.92339861,0.92373735,0.92448193,0.92520696,0.92566025,0.92594701,0.92618257,0.92638814,0.92651719,0.92648327,0.92637479,0.92633927,0.926287,0.92642921,0.92693663,0.92736846,0.9275772,0.9277364,0.92787528,0.92800266,0.92812353,0.92824221,0.92835951,0.9284569,0.92847592,0.92848867,0.92864043,0.92882562,0.92889982,0.92882615,0.92855382,0.92829108,0.92827237,0.92811114,0.9269321,0.92406058,0.92080468,0.92072189,0.92369473,0.92468601,0.92323232,0.92350107,0.92598635,0.92852718,0.93012494,0.930933,0.93133742,0.93155801,0.93172395,0.93188095,0.93202835,0.93215656,0.93227708,0.93241316,0.93257082,0.9326883,0.93242162,0.92985982,0.91816264,0.89087015,0.8621009,0.85911453,0.88017362,0.89099431,0.8812924,0.877738,0.88992149,0.90577054,0.91881865,0.9274832,0.93194783,0.93384212,0.9346205,0.93497062,0.9351247,0.93503469,0.9336381,0.92589563,0.90581155,0.87835842,0.8619777,0.87336707,0.89425963,0.89229488,0.87980533,0.88150573,0.89506561,0.91044974,0.92159277,0.92785299,0.93152881,0.93398345,0.93558627,0.93657327,0.93716955,0.93745601,0.93747365,0.93744278,0.93760872,0.93792379,0.93813008,0.93806058,0.93755722,0.93617886,0.93375492,0.93131071,0.93079758,0.93315268,0.93533236,0.93427753,0.93271053,0.93352121,0.93564773,0.93756115,0.93877745,0.93942058,0.93985665,0.94027954,0.94049317,0.94044155,0.94044274,0.9406445,0.94089633,0.94107777,0.94123888,0.94142985,0.94159418,0.94172019,0.94186413,0.94202119,0.94216037,0.94229311,0.94243294,0.94257903,0.94272149,0.94285482,0.94297808,0.94308543,0.94317538,0.94326442,0.94337445,0.9435041,0.94362307,0.94370532,0.94376153,0.94383699,0.94396591,0.94411832,0.94423956,0.94433552,0.94444239,0.9445591,0.94467515,0.94479585,0.94491804,0.94503373,0.94514358,0.9452495,0.94535387,0.9454577,0.94556153,0.94566417,0.94576567,0.94586718,0.94596928,0.9460721,0.94617379,0.94627392,0.94637424,0.94647527,0.94657648,0.94667715,0.94677752,0.946877,0.94697648,0.94707507,0.94715971,0.94721019,0.94726688,0.94738328,0.94751674,0.94761503,0.94770002,0.94779348,0.94785428,0.94786823,0.9479183,0.94805902,0.948228,0.94833881,0.94840646,0.94849092,0.94859743,0.94871306,0.94882792,0.94893652,0.94904238,0.94912392,0.94917601,0.94925445,0.94938046,0.94950539,0.94959968,0.94968015,0.94976813,0.94986385,0.94996083,0.95005751,0.95015103,0.9502393,0.95032519,0.95041591,0.95051146,0.95060492,0.95069331,0.95077986,0.95086741,0.95095575,0.9510448,0.95113409,0.95122278,0.9513101,0.95139706,0.95148343,0.9515698,0.95165575,0.95174056,0.95182502,0.95190954,0.95199376,0.95207804,0.95216262,0.9522469,0.95233077,0.95241398,0.95249623,0.95257872,0.95266134,0.95274383,0.95282573,0.95290715,0.95298839,0.95306945,0.95315075,0.95323205,0.95331341,0.95339429,0.95347422,0.95355022,0.95362258,0.95369524,0.95372474,0.95370543,0.95345885,0.9522835,0.9500466,0.94784063,0.94735628,0.94652188,0.93950015,0.93491262,0.94197011,0.94910157,0.95087361,0.95159394,0.95201236,0.95276535,0.95369548,0.95426565,0.95457137,0.95476937,0.95489198]}
        ,"selected":{"id":"51575","type":"Selection"},"selection_policy":{"id":"51576","type":"UnionRenderers"}},"id":"51564","type":"ColumnDataSource"},{"attributes":{"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"51565","type":"Line"}
        ,{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"51566","type":"Line"},{"attributes":{"data_source":{"id":"51564","type":"ColumnDataSource"}
        ,"glyph":{"id":"51565","type":"Line"},"hover_glyph":'null',"muted_glyph":'null',"nonselection_glyph":{"id":"51566","type":"Line"},"selection_glyph":'null',"view":{"id":"51568","type":"CDSView"}}
        ,"id":"51567","type":"GlyphRenderer"},{"attributes":{"source":{"id":"51564","type":"ColumnDataSource"}},"id":"51568","type":"CDSView"},{"attributes":{"dimension":1,"ticker":{"id":"51545","type":"BasicTicker"}}
        ,"id":"51548","type":"Grid"},{"attributes":{},"id":"51549","type":"PanTool"},{"attributes":{"axis_label":"TRANSMITTANCE","formatter":{"id":"51574","type":"BasicTickFormatter"},"ticker":{"id":"51545","type":"BasicTicker"}}
        ,"id":"51544","type":"LinearAxis"},{"attributes":{},"id":"51545","type":"BasicTicker"},{"attributes":{"ticker":{"id":"51540","type":"BasicTicker"}},"id":"51543","type":"Grid"},{"attributes":{},"id":"51540","type":"BasicTicker"}
        ,{"attributes":{},"id":"51572","type":"BasicTickFormatter"}],"root_ids":["51530"]},"title":"Bokeh Application","version":"1.4.0"}}



docs_json = {"260fd96e-cdc7-4108-8b09-310152a233e3":{"roots":{"references":[{"attributes":{"data_source":{"id":"64221","type":"ColumnDataSource"},"glyph":{"id":"64222","type":"Line"},"hover_glyph":'null',"muted_glyph":'null',"nonselection_glyph":{"id":"64223","type":"Line"},"selection_glyph":'null',"view":{"id":"64225","type":"CDSView"}},"id":"64224","type":"GlyphRenderer"},{"attributes":{"line_alpha":0.1,"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"64223","type":"Line"},{"attributes":{"line_color":"#1f77b4","x":{"field":"x"},"y":{"field":"y"}},"id":"64222","type":"Line"},{"attributes":{"callback":'null',"data":{"x":[0.9,0.9018,0.9036,0.9054,0.9072,0.909,0.9108,0.9126,0.9144,0.9162,0.918,0.9198,0.9216,0.9234,0.9252,0.927,0.9288,0.9306,0.9324,0.9342,0.936,0.9378,0.9396,0.9414,0.9432,0.945,0.9468,0.9486,0.9504,0.9522,0.954,0.9558,0.9576,0.9594,0.9612,0.963,0.9648,0.9666,0.9684,0.9702,0.972,0.9738,0.9756,0.9774,0.9792,0.981,0.9828,0.9846,0.9864,0.9882,0.99,0.9918,0.9936,0.9954,0.9972,0.999,1.0008,1.0026,1.0044,1.0062,1.008,1.0098,1.0116,1.0134,1.0152,1.017,1.0188,1.0206,1.0224,1.0242,1.026,1.0278,1.0296,1.0314,1.0332,1.035,1.0368,1.0386,1.0404,1.0422,1.044,1.0458,1.0476,1.0494,1.0512,1.053,1.0548,1.0566,1.0584,1.0602,1.062,1.0638,1.0656,1.0674,1.0692,1.071,1.0728,1.0746,1.0764,1.0782,1.08,1.0818,1.0836,1.0854,1.0872,1.089,1.0908,1.0926,1.0944,1.0962,1.098,1.0998,1.1016,1.1034,1.1052,1.107,1.1088,1.1106,1.1124,1.1142,1.116,1.1178,1.1196,1.1214,1.1232,1.125,1.1268,1.1286,1.1304,1.1322,1.134,1.1358,1.1376,1.1394,1.1412,1.143,1.1448,1.1466,1.1484,1.1502,1.152,1.1538,1.1556,1.1574,1.1592,1.161,1.1628,1.1646,1.1664,1.1682,1.17,1.1718,1.1736,1.1754,1.1772,1.179,1.1808,1.1826,1.1844,1.1862,1.188,1.1898,1.1916,1.1934,1.1952,1.197,1.1988,1.2006,1.2024,1.2042,1.206,1.2078,1.2096,1.2114,1.2132,1.215,1.2168,1.2186,1.2204,1.2222,1.224,1.2258,1.2276,1.2294,1.2312,1.233,1.2348,1.2366,1.2384,1.2402,1.242,1.2438,1.2456,1.2474,1.2492,1.251,1.2528,1.2546,1.2564,1.2582,1.26,1.2618,1.2636,1.2654,1.2672,1.269,1.2708,1.2726,1.2744,1.2762,1.278,1.2798,1.2816,1.2834,1.2852,1.287,1.2888,1.2906,1.2924,1.2942,1.296,1.2978,1.2996,1.3014,1.3032,1.305,1.3068,1.3086,1.3104,1.3122,1.314,1.3158,1.3176,1.3194,1.3212,1.323,1.3248,1.3266,1.3284,1.3302,1.332,1.3338,1.3356,1.3374,1.3392,1.341,1.3428,1.3446,1.3464,1.3482,1.35,1.3518,1.3536,1.3554,1.3572,1.359,1.3608,1.3626,1.3644,1.3662,1.368,1.3698,1.3716,1.3734,1.3752,1.377,1.3788,1.3806,1.3824,1.3842,1.386,1.3878,1.3896,1.3914,1.3932,1.395,1.3968,1.3986,1.4004,1.4022,1.404,1.4058,1.4076,1.4094,1.4112,1.413,1.4148,1.4166,1.4184,1.4202,1.422,1.4238,1.4256,1.4274,1.4292,1.431,1.4328,1.4346,1.4364,1.4382,1.44,1.4418,1.4436,1.4454,1.4472,1.449,1.4508,1.4526,1.4544,1.4562,1.458,1.4598,1.4616,1.4634,1.4652,1.467,1.4688,1.4706,1.4724,1.4742,1.476,1.4778,1.4796,1.4814,1.4832,1.485,1.4868,1.4886,1.4904,1.4922,1.494,1.4958,1.4976,1.4994,1.5012,1.503,1.5048,1.5066,1.5084,1.5102,1.512,1.5138,1.5156,1.5174,1.5192,1.521,1.5228,1.5246,1.5264,1.5282,1.53,1.5318,1.5336,1.5354,1.5372,1.539,1.5408,1.5426,1.5444,1.5462,1.548,1.5498,1.5516,1.5534,1.5552,1.557,1.5588,1.5606,1.5624,1.5642,1.566,1.5678,1.5696,1.5714,1.5732,1.575,1.5768,1.5786,1.5804,1.5822,1.584,1.5858,1.5876,1.5894,1.5912,1.593,1.5948,1.5966,1.5984,1.6002,1.602,1.6038,1.6056,1.6074,1.6092,1.611,1.6128,1.6146,1.6164,1.6182,1.62,1.6218,1.6236,1.6254,1.6272,1.629,1.6308,1.6326,1.6344,1.6362,1.638,1.6398,1.6416,1.6434,1.6452,1.647,1.6488,1.6506,1.6524,1.6542,1.656,1.6578,1.6596,1.6614,1.6632,1.665,1.6668,1.6686,1.6704,1.6722,1.674,1.6758,1.6776,1.6794,1.6812,1.683,1.6848,1.6866,1.6884,1.6902,1.692,1.6938,1.6956,1.6974,1.6992],"y":[0.59227401,0.62127179,0.67255694,0.67756969,0.62744361,0.59625566,0.5973081,0.58720857,0.57184684,0.57199949,0.60594022,0.66435748,0.68998158,0.67613643,0.65707123,0.60368282,0.48542705,0.34520411,0.22640012,0.16538496,0.16411635,0.21771282,0.30046582,0.31363401,0.2736007,0.25928414,0.26703629,0.28334859,0.29553491,0.30739456,0.32629982,0.34855315,0.36599129,0.37975249,0.41642392,0.45545778,0.48130751,0.54067528,0.632164,0.68095469,0.66600299,0.62704229,0.61675835,0.64117908,0.67040086,0.70774382,0.74176395,0.77200276,0.80283159,0.8202123,0.82861346,0.83590519,0.84235078,0.84824437,0.85087109,0.85003954,0.8475312,0.84615815,0.84946018,0.85215908,0.84968776,0.84830332,0.85246921,0.85623288,0.85699582,0.85722417,0.85746062,0.85783917,0.8570556,0.85680723,0.85873121,0.86029679,0.86171234,0.86339289,0.86455017,0.86528659,0.86561102,0.86587662,0.86613667,0.86639011,0.86663258,0.86672205,0.86655039,0.86613381,0.86559099,0.86487764,0.86384809,0.86224943,0.86037582,0.85873491,0.85713798,0.85568345,0.85467339,0.85378242,0.85394609,0.85554361,0.85440457,0.85245126,0.85305542,0.85022384,0.84510553,0.84065759,0.83105713,0.82059366,0.81834704,0.81811333,0.81184435,0.79755247,0.77930003,0.76161337,0.7329461,0.69528878,0.66818511,0.64643091,0.62327027,0.59912282,0.57653737,0.54530817,0.47451213,0.36240771,0.26089779,0.20765051,0.17415717,0.13970619,0.11741624,0.12076492,0.12236816,0.13680944,0.2018677,0.20474626,0.13556994,0.16811083,0.28651559,0.3354972,0.31043884,0.26547173,0.19313614,0.17605354,0.23233919,0.26084402,0.26953503,0.30719119,0.37692308,0.43414393,0.46514732,0.52512485,0.598405,0.61253768,0.61351341,0.65556985,0.69320709,0.69200206,0.6862396,0.71242708,0.72380942,0.70631409,0.68493563,0.66690511,0.68351084,0.69347501,0.68256825,0.7145983,0.7521717,0.75546974,0.75299519,0.74395496,0.72445333,0.7267133,0.73258764,0.73895538,0.76680136,0.77627683,0.7653209,0.76199567,0.76838851,0.77974284,0.80242842,0.82367653,0.82445461,0.82006687,0.82761723,0.83675545,0.84237838,0.85613257,0.86851728,0.87336653,0.8795951,0.88410872,0.88598359,0.88711381,0.88732886,0.88759238,0.88694787,0.8852669,0.88277841,0.87973845,0.87554193,0.8703174,0.86495143,0.85527754,0.83407372,0.80551809,0.78362304,0.77566922,0.75460094,0.738352,0.77564389,0.81754172,0.83181554,0.84366554,0.85389018,0.86172438,0.87175709,0.87932926,0.87920719,0.86925703,0.86014044,0.85635298,0.84895009,0.83472544,0.81348211,0.80050153,0.79538083,0.78428191,0.76539499,0.74666643,0.73728281,0.71675724,0.68923241,0.65596008,0.61401194,0.62816155,0.63872021,0.59559298,0.57623112,0.57740653,0.57750469,0.53203863,0.44196707,0.36559954,0.33311611,0.36079371,0.38532159,0.38416862,0.36382058,0.32410026,0.27658096,0.19298436,0.10544086,0.05017282,0.02199806,0.00863276,0.00099204,0.0001084,8.78e-06,3.56e-06,4e-07,3.5e-07,1.14e-06,1.68e-06,8.4e-07,1.6e-07,1.66e-06,3.058e-05,8.395e-05,9.079e-05,4.523e-05,1.02e-05,9e-07,8.01e-06,4.038e-05,0.00010066,0.00014594,0.0001243,6.302e-05,8.759e-05,0.00027953,0.00036072,0.00059578,0.00104803,0.00086523,0.00060553,0.00092432,0.0015913,0.00327555,0.00537282,0.01136734,0.01701822,0.01294058,0.0153436,0.02920338,0.04093117,0.04735931,0.05135098,0.06966156,0.07585803,0.0509324,0.04206652,0.04998804,0.05465847,0.05793823,0.05956462,0.06043348,0.06769191,0.10614418,0.12254972,0.10199884,0.1379409,0.1900014,0.21887338,0.25449607,0.24992001,0.22281148,0.21796556,0.19122307,0.15118618,0.12345031,0.09112455,0.13197494,0.22381961,0.22667512,0.17480351,0.17286246,0.23885901,0.29643035,0.27338481,0.25601038,0.3470014,0.44395816,0.46621418,0.49464914,0.54066753,0.58159721,0.63652945,0.65911442,0.61222172,0.62021232,0.6967864,0.72944278,0.75378013,0.75884008,0.74003541,0.75082654,0.76210636,0.78558427,0.83290398,0.85685128,0.84920156,0.84277612,0.85038817,0.86077583,0.87584871,0.88938504,0.89124632,0.89469367,0.90150613,0.90243369,0.90093434,0.90399086,0.91204977,0.91854298,0.91884744,0.9177677,0.92104405,0.92523414,0.92680532,0.92681038,0.92467439,0.92214179,0.92235553,0.92115515,0.90979612,0.88287699,0.85651159,0.85862684,0.87529051,0.87501073,0.87099189,0.88287425,0.9005127,0.91351211,0.92151242,0.92575431,0.92760879,0.92817974,0.92793787,0.92606246,0.92145884,0.90821201,0.88176119,0.86018133,0.86778331,0.88467652,0.88066107,0.87428325,0.88452613,0.90185362,0.91594678,0.92350525,0.92745179,0.93086958,0.93317139,0.93359959,0.93353033,0.93352914,0.93271959,0.93025392,0.92757946,0.92733544,0.9263097,0.92179394,0.91792405,0.91620761,0.91432166,0.91293156,0.91187942,0.91003144,0.90835756,0.90930754,0.91347009,0.91801119,0.92277265,0.92490983,0.92174065,0.91057873,0.89497656,0.89727366,0.91441625,0.92376131,0.9252243,0.92220235,0.91646814,0.91658616,0.92348319,0.92381853,0.91942871,0.92247921,0.92426223,0.91081637,0.89221245,0.89459866,0.91234648,0.91655678,0.90595555,0.89563257]},"selected":{"id":"64232","type":"Selection"},"selection_policy":{"id":"64233","type":"UnionRenderers"}},"id":"64221","type":"ColumnDataSource"},{"attributes":{},"id":"64206","type":"PanTool"},{"attributes":{"text":""},"id":"64227","type":"Title"},{"attributes":{"ticker":{"id":"64197","type":"BasicTicker"}},"id":"64200","type":"Grid"},{"attributes":{"source":{"id":"64221","type":"ColumnDataSource"}},"id":"64225","type":"CDSView"},{"attributes":{},"id":"64202","type":"BasicTicker"},{"attributes":{},"id":"64229","type":"BasicTickFormatter"},{"attributes":{},"id":"64209","type":"ResetTool"},{"attributes":{"overlay":{"id":"64234","type":"BoxAnnotation"}},"id":"64208","type":"BoxZoomTool"},{"attributes":{"callback":'null'},"id":"64188","type":"DataRange1d"},{"attributes":{"callback":'null',"overlay":{"id":"64235","type":"BoxAnnotation"}},"id":"64211","type":"BoxSelectTool"},{"attributes":{},"id":"64194","type":"LinearScale"},{"attributes":{},"id":"64197","type":"BasicTicker"},{"attributes":{"axis_label":"WAVELENGTH (microns)","formatter":{"id":"64229","type":"BasicTickFormatter"},"ticker":{"id":"64197","type":"BasicTicker"}},"id":"64196","type":"LinearAxis"},{"attributes":{"callback":'null'},"id":"64212","type":"HoverTool"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":0},}],},},}


extract_from_MODTRAN(docs_json, 450, 1500) 
